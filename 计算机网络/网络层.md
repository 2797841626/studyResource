IP数据报格式：
首部长度：4字节，单位为4B，所以首部长度最大为(2^4-1) * 4B = 60B
首部至少20B
若首部长度不是4的整数倍，会在填充区进行填充
数据报长度：16字节，单位为1B
生存时间：每经过一个路由器，时间减一，防止数据报无止境的在网络中传输。
源地址和目的地址均为12位，是MAC地址.。
标识：区分不同分片
标志：总共有三位 只有两位有意义 DF与MF 
DF（don't fragment）=1 表示禁止分片 反之允许分片。
MF(more fragment) = 1后面还有分片 ，反之后面没有分片
片偏移：以8B为单位


以太网MTU（最大传送单元） = 1500B。

分类的IP地址：
A类：网络号占1B，且第一位为0
B类：网络号占2B，且前两位为10
C类：网络号占3B，且前三位为110
D类：多播地址，前四位为1110
特殊IP地址：
网络号与主机全0，或网络号全0主机号为特定值可作为源地址，但不可做为目的地址
网络号与主机号全1或只有主机号全1可表示广播地址，但不可作为源地址.
网络号为127，表示环回地址 是A类地址

网络地址转换技术（NAT）：
维护一个NAT转换表，将本地地址转换成有效的外部全球IP地址，实现与因特网的连接

子网划分：得需要掩码帮助，来提出网络号和子网号

无分类编址（CIDR）：使用/num来表示网络号的位数例如192.199.177.82/27
构成超网：对网络号取交集即可，剩余的全0.
最长前缀匹配：选择具有最长网络前缀的路由。解决选择哪个路由项的问题
将目的地址与目的网络的子网掩码相与，得到的结果若与目的网络相同则表示匹配，然后选择匹配里面网络前缀最长的。若没有匹配的则发送给默认路由（网络地址全0），即交给下一个路由。

解决IP地址耗尽的主要措施：
采用无类别编制CIDR，使IP地址分配更加合理；
采用网络地址转换NAT，以节省全球IP地址；
采用具有更大地址空间的IPv6.（从根本上解决了IP地址耗尽的问题）

ARP协议：解决MAC地址的问题
ARP高速缓存：IP地址与MAC地址的映射
映射如何来：通过广播请求和单播响应而来。
首先检查缓存，有直接用，没有则发送广播请求MAC地址
如果不属于同一个子网，则去请求路由器的的MAC地址，让路由器代理传输，
如果属于同一个子网，则直接去广播请求目的地址的MAC地址，然后直接传输。
这个过程IP地址始终不变，MAC地址会随着交换信息设备的改变而改变。

DHCP协议：
DHCP服务器用于动态配置IP地址。客户/服务器模式基于UDP
来回确认两次，均是发送广播

ICMP协议：
ICMP差错报告报文被封装在IP数据报的数据部分
具体应用：ping，traceroute

路由表中，每个路由项包含了目的网络的地址和与之关联的下一跳信息。

内部网关协议：
RIP协议：只适用于小网络
广播UDP报文 传输层协议
每个路由器维护从它到其他目的网络的唯一最佳记录 距离：跳数。
RIP只允许一条路最多包含15个路由器，即距离16的网络不可达。
只向周围节点发送自身路由表信息

OSPF协议：
采用IP数据报传送 网络层协议
适用大网络
使路由器有内部网络所有节点的连接信息，通过dijkstra算法算出到每个节点的最短路径
泛洪发送相邻的所有路由器的链路状态

外部网关协议：
BGP协议：
应用层协议，借助TCP传送。相互之间交换路由信息


IP组播：
组播的概念
组播机制是让源主机一次发送的单个分组可以抵达由一个组播地址标识的若干目的主机，并被他们正确接受.

注意：
组播仅用于 **UDP**；
组播地址使用 **D类地址**格式；
主机组播时仅发送一份数据，只有数据在传送到 **分岔路径**上时才将 **分组复制**后继续转发;
